"use strict";var tmpl;!function(){var a={};tmpl=function b(c,d){var e=/\W/.test(c)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):a[c]=a[c]||b(document.getElementById(c).innerHTML);return d?e(d):e}}();var selProd={id:0,qty:0,selected:0},handleSteps,bindEvents;$(document).ready(function(){if($("[data-toggle=offcanvas]").click(function(){$(".row-offcanvas").toggleClass("active")}),$(document.body).on("click",".dropdown-menu li",function(a){var b=$(a.currentTarget);return $(".glyphicon.glyphicon-ok.pull-right.selected").remove(),b.find("a").prepend('<span class="glyphicon glyphicon-ok pull-right selected">&nbsp;</span>'),b.closest(".btn-group").find('[data-bind="label"]').text(b.text()).end().children(".dropdown-toggle").dropdown("toggle"),$("#selectedSite strong").text(b.text()),$(this).parents(".selection-parent").find(".list_sel").hide().removeClass("shown"),$(this).parents(".selection-parent").find(".list_"+$(b).attr("class").split(" ")[0]).show().addClass("shown"),$(this).parents(".selection-parent").find(".filter-list-txt").prop("disabled",!1).val(""),!1}),$(".productInfoLink").on("click",function(){$("#infoModal").modal(),$("#infoModal .modal-body").html(tmpl("loadingTmpl")),setTimeout(function(){$.ajax({url:$("#licJSONUrl").val().trim(),"content-type":"json",success:function(a){$("#infoModal .modal-title").html(a.product_name),$("#infoModal .modal-body").html(tmpl("productInfoTmpl",{resp:a}))}})},999)}),bindEvents=function(){$(".next-step").click(function(){handleSteps(this)}),$(".sel_system")&&($(".alert.alert-danger.done,.alert.alert-danger.incomplete").hide(),$(".sel_system").on("click",function(){$(".alert.alert-danger.done,.alert.alert-danger.incomplete").hide();var b=$(this).parents(".selection-parent"),c=b.find(".prod-sel-qty-exp"),d=b.find(".prod-sel-qty-act");if($(this).prop("checked")&&parseInt(c.val())===parseInt(d.val()))return $(".alert.alert-danger.done").show(),!1;if($(this).is(":checked")){var e={};e.systemName=$(this).parent().find("label").text().trim(),e.id=$(this).data("id"),b.find(".selected-list").append(tmpl("selectedTmpl",e)),d.val(parseInt(d.val())+1),a(b,d.val()),$(".remove-item").on("click",function(){var c=$(this).data("id");$(this).parent().remove(),b.find("[data-id="+c+"]").prop("checked",!1),d.val(parseInt(d.val())-1),a(b,d.val())})}else d.val(parseInt(d.val())-1),a(b,d.val()),$($("[data-id="+$(this).data("id")+"]").get(1)).parent().remove()})),$(".filter-list-txt").on("keyup",function(){var a=$.trim($(this).val());$(this).parents(".selection-parent").find("li.shown").each(function(){$(this).text().toLowerCase().indexOf(a.toLowerCase())>=0?$(this).show():$(this).hide()})});var a=function(a,b){a.find(".selCount").text(b)};$("#tnc").on("change",function(){$(this).is(":checked")?$("#step4Next").removeClass("disabled"):$("#step4Next").addClass("disabled")}),$(".prod-sel").on("change",function(){$(this).is(":checked")?$(this).closest("tr").find(".qty-to-act-picker").prop("disabled",!1):$(this).closest("tr").find(".qty-to-act-picker").prop("disabled",!0),$(".prod-sel").is(":checked")?$("[data-nextid=step2]").removeClass("disabled"):$("[data-nextid=step2]").addClass("disabled")})},bindEvents(),handleSteps=function(a){var b,c="object"==typeof a?$(a).data("nextid"):a.replace("#","");"step2"===c?(b=$("#step2JSONUrl").val().trim(),$("#sidebar a").removeClass("active"),$($("#sidebar a").get(1)).addClass("active"),selProd.selectedProds=[],$(".prod-sel").each(function(){var a=$(this),b={};a.is(":checked")&&(b.name=$(a.parents("tr").find("td").get(1)).text().trim(),b.qty=a.parents("tr").find(".qty-to-act-picker").val(),selProd.selectedProds.push(b))})):"step3"===c?($(".alert.alert-danger.incomplete").hide(),$(".error-holder.panel-danger").addClass("panel-default").removeClass("panel-danger"),$(".prod-sel-qty-exp").each(function(){var a=parseInt($(this).val().trim()),b=parseInt($(this).next().val().trim());return a!==b&&($(".alert.alert-danger.incomplete").show(),$(this).parents(".error-holder").removeClass("panel-default").addClass("panel-danger")),!1}),selProd.selectedSystems=[],$("#selectedList li").each(function(){var a={};a.sysName=$(this).text().trim(),selProd.selectedSystems.push(a)}),$("#sidebar a").removeClass("active"),$($("#sidebar a").get(2)).addClass("active")):"step4"===c?(b=$("#step4JSONUrl").val().trim(),$("#sidebar a").removeClass("active"),$($("#sidebar a").get(3)).addClass("active")):"step5"===c&&(b=$("#step5JSONUrl").val().trim(),$("#sidebar a").removeClass("active"),$($("#sidebar a").get(4)).addClass("active")),$(".steps-data").hide(),$("#wrapper").html(tmpl("loadingTmpl")).show(),setTimeout(function(){b?$.ajax({url:b,"content-type":"json",success:function(a){$("#wrapper").hide(),a.selProdQty=selProd.qty,selProd.selectedProds&&(a.selectedProds=selProd.selectedProds),$("#"+c+"-contents").show().html(tmpl(c,{resp:a})),$(location).attr("hash","#"+c),bindEvents()}}):($("#wrapper").hide(),$("#"+c+"-contents").show().html(tmpl(c,{resp:selProd})),$(location).attr("hash","#"+c),bindEvents())},999)},$(location).attr("pathname").indexOf("wizard.html")>0){var a=$(location).attr("hash");a?("#step2"===a||"#step3"===a||"#step4"===a||"#step5"===a)&&handleSteps(a):($(location).attr("hash","#step1"),window.location.reload(!0))}});